<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:composition template="./master.xhtml">
        <ui:define name="extrastyle">

        </ui:define>

        <ui:define name="navbar">
            <h3>
                <h:outputFormat value="Welcome, {0}!" rendered="${activeUserMB.logged}">
                    <f:param value="#{activeUserMB.userName}"/>
                </h:outputFormat>
            </h3>
            <li>
                <h:form>
                    <h:commandLink action="#{activeUserMB.actionLogout()}" rendered="${activeUserMB.logged}" >
                        Log out
                    </h:commandLink>
                </h:form>
                <h:link  outcome="login" rendered="${!activeUserMB.logged}" >
                    Log in
                </h:link>                    
            </li>
        </ui:define>

        <ui:define name="content">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <textarea id="msg" rows="2" cols="25">
                        </textarea>
                        <p id="msgArea" >
                            
                        </p>
                    </div>
                </div>
            </div>
        </ui:define>
        <ui:define name="extrajs" >
            <script>
                $(function(){
                    setInterval(function() {
                        var datetime = new Date().getTime();
                        $.getJSON("restapiv1/message/" + datetime)
                          .done(function (data) {
                              // On success, 'data' contains a list of products.
                              //$('#top10books').empty();
                              $.each(data, function (key, value) {
                                  // Add a list item for the product.
                                  $('<li>', { text: value.roomNumber + "    " +value.msgText}).appendTo($('#msgArea'));
                                  //$('</li>', { text: "").appendTo($('#msgArea'));
                              });
                          }); 
                    }, 5000); 
                });
            </script>
        </ui:define>
    </ui:composition>
</html>

